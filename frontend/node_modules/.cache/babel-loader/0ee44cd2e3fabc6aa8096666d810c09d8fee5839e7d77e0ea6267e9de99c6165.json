{"ast":null,"code":"import _objectSpread from\"D:/AliMunishiApp/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{useState,useEffect}from\"react\";import'../styles/History.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function History(){const[consumers,setConsumers]=useState([]);const[readings,setReadings]=useState([]);const[selectedId,setSelectedId]=useState(\"\");const[showScrollTop,setShowScrollTop]=useState(false);const API_URL=process.env.REACT_APP_API_URL;useEffect(()=>{fetch(\"\".concat(API_URL,\"/consumers\")).then(res=>res.json()).then(data=>{if(Array.isArray(data))setConsumers(data);else{console.error(\"Data nga backend për konsumatorët nuk është array:\",data);setConsumers([]);}}).catch(err=>{console.error('Gabim gjatë marrjes së konsumatorëve:',err);setConsumers([]);});},[API_URL]);useEffect(()=>{if(!selectedId){setReadings([]);return;}fetch(\"\".concat(API_URL,\"/readings/\").concat(selectedId)).then(res=>res.json()).then(data=>{if(Array.isArray(data)){const readingsWithDates=data.map(r=>_objectSpread(_objectSpread({},r),{},{date:new Date(r.date)}));setReadings(readingsWithDates);}else{console.error(\"Data nga backend për leximet nuk është array:\",data);setReadings([]);}}).catch(err=>{console.error('Gabim gjatë marrjes së leximeve:',err);setReadings([]);});},[selectedId,API_URL]);useEffect(()=>{const handleScroll=()=>{setShowScrollTop(window.scrollY>300);};window.addEventListener('scroll',handleScroll);return()=>window.removeEventListener('scroll',handleScroll);},[]);const selectedConsumer=consumers.find(c=>c.id===parseInt(selectedId));return/*#__PURE__*/_jsxs(\"div\",{className:\"history-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Historiku i leximeve\"}),/*#__PURE__*/_jsxs(\"select\",{value:selectedId,onChange:e=>setSelectedId(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Zgjedh konsumatorin\"}),consumers.map(c=>/*#__PURE__*/_jsxs(\"option\",{value:c.id,children:[c.name,\" \",c.surname]},c.id))]}),selectedId&&/*#__PURE__*/_jsxs(\"div\",{className:\"history-table-container\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Lexime p\\xEBr: \",selectedConsumer?\"\".concat(selectedConsumer.name,\" \").concat(selectedConsumer.surname):'N/A']}),readings.length>0?/*#__PURE__*/_jsxs(\"table\",{className:\"history-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Data\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Leximi m\\xEBparsh\\xEBm\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Leximi aktual\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Konsumi\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Pagesa\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:readings.map(r=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{\"data-label\":\"Data\",children:r.date.toLocaleDateString()}),/*#__PURE__*/_jsx(\"td\",{\"data-label\":\"Gjendja paraprake\",children:r.previousReading}),/*#__PURE__*/_jsx(\"td\",{\"data-label\":\"Gjendja e fundit\",children:r.currentReading}),/*#__PURE__*/_jsxs(\"td\",{\"data-label\":\"Uj\\xEB i harxhuar\",children:[r.consumption,\" m\\xB3\"]}),/*#__PURE__*/_jsxs(\"td\",{\"data-label\":\"Pagesa\",children:[r.total.toFixed(2),\" MKD\"]})]},r.id))})]}):/*#__PURE__*/_jsx(\"p\",{children:\"Nuk ka lexime p\\xEBr k\\xEBt\\xEB konsumator.\"})]}),showScrollTop&&/*#__PURE__*/_jsx(\"button\",{className:\"scroll-to-top-float\",onClick:()=>window.scrollTo({top:0,behavior:'smooth'}),\"aria-label\":\"Kthehu lart\",children:\"\\u2191\"})]});}","map":{"version":3,"names":["useState","useEffect","jsx","_jsx","jsxs","_jsxs","History","consumers","setConsumers","readings","setReadings","selectedId","setSelectedId","showScrollTop","setShowScrollTop","API_URL","process","env","REACT_APP_API_URL","fetch","concat","then","res","json","data","Array","isArray","console","error","catch","err","readingsWithDates","map","r","_objectSpread","date","Date","handleScroll","window","scrollY","addEventListener","removeEventListener","selectedConsumer","find","c","id","parseInt","className","children","value","onChange","e","target","name","surname","length","toLocaleDateString","previousReading","currentReading","consumption","total","toFixed","onClick","scrollTo","top","behavior"],"sources":["D:/AliMunishiApp/frontend/src/pages/History.jsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport '../styles/History.css';\r\n\r\nexport default function History() {\r\n  const [consumers, setConsumers] = useState([]);\r\n  const [readings, setReadings] = useState([]);\r\n  const [selectedId, setSelectedId] = useState(\"\");\r\n  const [showScrollTop, setShowScrollTop] = useState(false);\r\n\r\n  const API_URL = process.env.REACT_APP_API_URL;\r\n\r\n  useEffect(() => {\r\n    fetch(`${API_URL}/consumers`)\r\n      .then(res => res.json())\r\n      .then(data => {\r\n        if (Array.isArray(data)) setConsumers(data);\r\n        else {\r\n          console.error(\"Data nga backend për konsumatorët nuk është array:\", data);\r\n          setConsumers([]);\r\n        }\r\n      })\r\n      .catch(err => {\r\n        console.error('Gabim gjatë marrjes së konsumatorëve:', err);\r\n        setConsumers([]);\r\n      });\r\n  }, [API_URL]);\r\n\r\n  useEffect(() => {\r\n    if (!selectedId) {\r\n      setReadings([]);\r\n      return;\r\n    }\r\n    fetch(`${API_URL}/readings/${selectedId}`)\r\n      .then(res => res.json())\r\n      .then(data => {\r\n        if (Array.isArray(data)) {\r\n          const readingsWithDates = data.map(r => ({ ...r, date: new Date(r.date) }));\r\n          setReadings(readingsWithDates);\r\n        } else {\r\n          console.error(\"Data nga backend për leximet nuk është array:\", data);\r\n          setReadings([]);\r\n        }\r\n      })\r\n      .catch(err => {\r\n        console.error('Gabim gjatë marrjes së leximeve:', err);\r\n        setReadings([]);\r\n      });\r\n  }, [selectedId, API_URL]);\r\n\r\n  useEffect(() => {\r\n    const handleScroll = () => {\r\n      setShowScrollTop(window.scrollY > 300);\r\n    };\r\n    window.addEventListener('scroll', handleScroll);\r\n    return () => window.removeEventListener('scroll', handleScroll);\r\n  }, []);\r\n\r\n  const selectedConsumer = consumers.find(c => c.id === parseInt(selectedId));\r\n\r\n  return (\r\n    <div className=\"history-container\">\r\n      <h2>Historiku i leximeve</h2>\r\n\r\n      <select\r\n        value={selectedId}\r\n        onChange={(e) => setSelectedId(e.target.value)}\r\n      >\r\n        <option value=\"\">Zgjedh konsumatorin</option>\r\n        {consumers.map((c) => (\r\n          <option key={c.id} value={c.id}>\r\n            {c.name} {c.surname}\r\n          </option>\r\n        ))}\r\n      </select>\r\n\r\n      {selectedId && (\r\n        <div className=\"history-table-container\">\r\n          <h3>Lexime për: {selectedConsumer ? `${selectedConsumer.name} ${selectedConsumer.surname}` : 'N/A'}</h3>\r\n          {readings.length > 0 ? (\r\n            <table className=\"history-table\">\r\n              <thead>\r\n                <tr>\r\n                  <th>Data</th>\r\n                  <th>Leximi mëparshëm</th>\r\n                  <th>Leximi aktual</th>\r\n                  <th>Konsumi</th>\r\n                  <th>Pagesa</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {readings.map((r) => (\r\n                  <tr key={r.id}>\r\n                    <td data-label='Data'>{r.date.toLocaleDateString()}</td>\r\n                    <td data-label='Gjendja paraprake'>{r.previousReading}</td>\r\n                    <td data-label='Gjendja e fundit'>{r.currentReading}</td>\r\n                    <td data-label='Ujë i harxhuar'>{r.consumption} m³</td>\r\n                    <td data-label='Pagesa'>{r.total.toFixed(2)} MKD</td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          ) : (\r\n            <p>Nuk ka lexime për këtë konsumator.</p>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {showScrollTop && (\r\n        <button \r\n          className=\"scroll-to-top-float\"\r\n          onClick={() => window.scrollTo({ top: 0, behavior: 'smooth' })}\r\n          aria-label=\"Kthehu lart\"\r\n        >\r\n          ↑\r\n        </button>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}